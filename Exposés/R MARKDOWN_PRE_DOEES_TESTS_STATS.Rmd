---

title: "PRETRAITEMENT DES DONNEES – Consommation alimentaire par zone"

author: "RIRADJIM NGARMOUNDOU Trésor"

institute: "École Nationale de la Statistique et de l'Analyse Économique de Dakar"

date: "`r format(Sys.Date(), '%d %B %Y')`"

output:
beamer\_presentation:
slide\_level: 2
theme: "Madrid"
colortheme: "dolphin"
toc: true
number\_sections: true
header-includes:
  - |
    \setbeamercolor{structure}{fg=green!60!black}
  - |
    \setbeamercolor{palette primary}{use=structure,fg=white,bg=green!60!black}
  - |
    \setbeamercolor{frametitle}{bg=green!60!black,fg=white}
  - |
    \setbeamercolor{title}{bg=white,fg=green!60!black}
---
```{r}
knitr::opts_chunk$set(echo=TRUE, warning=FALSE, message=FALSE)
library(haven)
library(dplyr)
library(ggplot2)
library(car)
library(rstatix)
library(kSamples)
```

```{r}
# 1. Chemins
zip_path <- "/Users/HP/Downloads/SEN2018_menage.zip"
out_dir  <- "/Users/HP/Downloads/SEN2018_menage"

# 2. Extraction
if (!dir.exists(out_dir) && file.exists(zip_path)) {
  unzip(zipfile = zip_path, exdir = out_dir)
}

# 3. Lecture .dta
dta_files <- list.files(out_dir, pattern = "\\.dta$", full.names = TRUE, recursive = TRUE)
liste_data <- setNames(lapply(dta_files, haven::read_dta), basename(dta_files))

# 4. Création ID et fusion
df_list <- lapply(liste_data, function(df) df %>% mutate(id = paste(grappe, menage, sep = "_")))

tbl_zone <- df_list[["s00_me_SEN2018.dta"]] %>%
  select(id, s00q04) %>%
  rename(zone_code = s00q04) %>%
  mutate(zone = ifelse(zone_code == 1, "Urbaine", "Rurale")) %>%
  select(id, zone)

tbl_conso_raw <- df_list[["s08b1_me_SEN2018.dta"]]
food_vars <- grep("^s08b02", names(tbl_conso_raw), value = TRUE)
tbl_conso <- tbl_conso_raw %>%
  select(id, all_of(food_vars)) %>%
  mutate(conso_total = rowSums(across(all_of(food_vars)), na.rm = TRUE)) %>%
  select(id, conso_total)

df <- inner_join(tbl_conso, tbl_zone, by = "id") %>%
  filter(conso_total > 0)
```

# Analyse des tests statistiques

## Visualisation avec boxplot

\begin{columns}
\column{0.5\textwidth}
Le diagramme en boîte (boxplot) permet une première exploration visuelle des différences entre les zones. On observe que la médiane de la consommation alimentaire est plus élevée en zone urbaine qu'en zone rurale. De plus, la dispersion semble plus importante en zone rurale, avec quelques valeurs extrêmes visibles. Cela suggère des différences de structure dans les distributions de consommation.

\column{0.5\textwidth}

```{r, fig.align='center', out.width='100%'}
ggplot(df, aes(zone, conso_total)) +
  geom_boxplot(fill = 'lightgreen') +
  labs(title = 'Consommation par zone', x = 'Zone', y = 'Conso totale')
```

